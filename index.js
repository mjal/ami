// Generated by CoffeeScript 1.7.1
(function() {
  var alias, default_site, do_search, input, query, sites, template;

  sites = {
    "google": function(query) {
      return "https://www.google.fr/search?q=" + query;
    },
    "google.com": function(query) {
      return "https://www.google.com/search?q=" + query;
    },
    "wikipedia": function(query) {
      return "http://fr.wikipedia.org/w/index.php?search=" + query;
    },
    "wikipedia.com": function(query) {
      return "http://www.wikipedia.org/w/index.php?search=" + query;
    },
    "youtube": function(query) {
      return "https://www.youtube.com/results?search_query=" + query;
    },
    "duckduckgo": function(query) {
      return "https://duckduckgo.com/?q=" + query;
    },
    "soundcloud": function(query) {
      return "https://soundcloud.com/search?q=" + query;
    }
  };

  alias = {
    "g": "google",
    "gfr": "google",
    "gus": "google.com",
    "w": "wikipedia",
    "wfr": "wikipedia",
    "wus": "wikipedia.com",
    "ddg": "duckduckgo",
    "sc": "soundcloud",
    "yt": "youtube"
  };

  default_site = "google";

  template = sites[default_site];

  do_search = function(sentence) {
    var bang, index, site, word, words, _i, _len;
    words = sentence.split(/\s+/);
    for (bang in alias) {
      site = alias[bang];
      index = 0;
      for (_i = 0, _len = words.length; _i < _len; _i++) {
        word = words[_i];
        console.log(word + ' => ' + bang);
        if (word === ('!' + bang)) {
          template = sites[site];
          words.splice(index, 1);
        }
        index++;
      }
    }
    return window.location.href = template(words.join('+'));
  };

  input = window.location.search;

  if (input && input.match(/^\?q=/)) {
    query = input.substring(3).replace(/\/$/, '').replace(/\+/g, ' ');
    console.log(decodeURIComponent(query));
    do_search(decodeURIComponent(query));
  }

}).call(this);
